<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1261px" preserveAspectRatio="none" style="width:757px;height:1261px;background:#FFFFFF;" version="1.1" viewBox="0 0 757 1261" width="757px" zoomAndPan="magnify"><defs/><g><rect fill="#DDDDDD" height="1242.5625" style="stroke:#181818;stroke-width:0.5;" width="246" x="90" y="6"/><rect fill="none" height="315.1641" style="stroke:#000000;stroke-width:1.5;" width="730.5" x="10" y="300.0703"/><rect fill="none" height="92.0547" style="stroke:#000000;stroke-width:1.5;" width="447.5" x="20" y="325.4219"/><rect fill="none" height="185.1094" style="stroke:#000000;stroke-width:1.5;" width="570.5" x="84" y="873.6953"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="57" x2="57" y1="42.6094" y2="1254.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="126" x2="126" y1="42.6094" y2="1254.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="319" x2="319" y1="42.6094" y2="1254.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="477.5" x2="477.5" y1="42.6094" y2="1254.5625"/><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="54" x="30" y="10"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="37" y="31.5332">phone</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65" x="94" y="10"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51" x="101" y="31.5332">dfplayer</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="25" x="307" y="10"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="11" x="314" y="31.5332">pi</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="54" x="450.5" y="10"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="457.5" y="31.5332">server</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="750.5" x="0" y="73.7852"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="750.5" y1="73.7852" y2="73.7852"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="750.5" y1="76.7852" y2="76.7852"/><rect fill="#EEEEEE" height="24.3516" style="stroke:#000000;stroke-width:2.0;" width="119" x="315.75" y="62.6094"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="101" x="321.75" y="80.1045">Pick up handset</text><polygon fill="#181818" points="307.5,115.3125,317.5,119.3125,307.5,123.3125,311.5,119.3125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="57" x2="313.5" y1="119.3125" y2="119.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="48" x="64" y="114.4561">off_hook</text><polygon fill="#181818" points="137.5,145.6641,127.5,149.6641,137.5,153.6641,133.5,149.6641" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="131.5" x2="318.5" y1="149.6641" y2="149.6641"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137" x="143.5" y="144.8076">play 0001_dialtone.mp3</text><polygon fill="#181818" points="465.5,176.0156,475.5,180.0156,465.5,184.0156,469.5,180.0156" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="319.5" x2="471.5" y1="180.0156" y2="180.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83" x="326.5" y="175.1592">send "offhook"</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="750.5" x="0" y="209.1914"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="750.5" y1="209.1914" y2="209.1914"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="750.5" y1="212.1914" y2="212.1914"/><rect fill="#EEEEEE" height="24.3516" style="stroke:#000000;stroke-width:2.0;" width="62" x="344.25" y="198.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="44" x="350.25" y="215.5107">dialing</text><polygon fill="#181818" points="307.5,250.7188,317.5,254.7188,307.5,258.7188,311.5,254.7188" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="57" x2="313.5" y1="254.7188" y2="254.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58" x="64" y="249.8623">on_dialing</text><polygon fill="#181818" points="137.5,281.0703,127.5,285.0703,137.5,289.0703,133.5,285.0703" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="131.5" x2="318.5" y1="285.0703" y2="285.0703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="60" x="143.5" y="280.2139">stop audio</text><path d="M10,300.0703 L83,300.0703 L83,308.4219 L73,318.4219 L10,318.4219 L10,300.0703 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="315.1641" style="stroke:#000000;stroke-width:1.5;" width="730.5" x="10" y="300.0703"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="25" y="314.5654">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="80" x="98" y="313.4893">[for each digit]</text><path d="M20,325.4219 L93,325.4219 L93,333.7734 L83,343.7734 L20,343.7734 L20,325.4219 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="92.0547" style="stroke:#000000;stroke-width:1.5;" width="447.5" x="20" y="325.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="35" y="339.917">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="109" x="108" y="338.8408">[for each dial pulse]</text><polygon fill="#181818" points="307.5,362.125,317.5,366.125,307.5,370.125,311.5,366.125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="57" x2="313.5" y1="366.125" y2="366.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="64" y="361.2686">on_pulse</text><line style="stroke:#181818;stroke-width:1.0;" x1="319.5" x2="361.5" y1="396.4766" y2="396.4766"/><line style="stroke:#181818;stroke-width:1.0;" x1="361.5" x2="361.5" y1="396.4766" y2="409.4766"/><line style="stroke:#181818;stroke-width:1.0;" x1="320.5" x2="361.5" y1="409.4766" y2="409.4766"/><polygon fill="#181818" points="330.5,405.4766,320.5,409.4766,330.5,413.4766,326.5,409.4766" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129" x="326.5" y="391.6201">increment count (digit)</text><polygon fill="#181818" points="307.5,442.8281,317.5,446.8281,307.5,450.8281,311.5,446.8281" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="57" x2="313.5" y1="446.8281" y2="446.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="81" x="64" y="441.9717">digit complete</text><polygon fill="#181818" points="465.5,473.1797,475.5,477.1797,465.5,481.1797,469.5,477.1797" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="319.5" x2="471.5" y1="477.1797" y2="477.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="72" x="326.5" y="472.3232">send &lt;digit&gt;</text><line style="stroke:#181818;stroke-width:1.0;" x1="477.5" x2="519.5" y1="507.5313" y2="507.5313"/><line style="stroke:#181818;stroke-width:1.0;" x1="519.5" x2="519.5" y1="507.5313" y2="520.5313"/><line style="stroke:#181818;stroke-width:1.0;" x1="478.5" x2="519.5" y1="520.5313" y2="520.5313"/><polygon fill="#181818" points="488.5,516.5313,478.5,520.5313,488.5,524.5313,484.5,520.5313" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="244" x="484.5" y="502.6748">append digit to phone number being dialed</text><line style="stroke:#181818;stroke-width:1.0;" x1="477.5" x2="519.5" y1="550.8828" y2="550.8828"/><line style="stroke:#181818;stroke-width:1.0;" x1="519.5" x2="519.5" y1="550.8828" y2="563.8828"/><line style="stroke:#181818;stroke-width:1.0;" x1="478.5" x2="519.5" y1="563.8828" y2="563.8828"/><polygon fill="#181818" points="488.5,559.8828,478.5,563.8828,488.5,567.8828,484.5,563.8828" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91" x="484.5" y="546.0264">start 4s timeout</text><line style="stroke:#181818;stroke-width:1.0;" x1="319.5" x2="361.5" y1="594.2344" y2="594.2344"/><line style="stroke:#181818;stroke-width:1.0;" x1="361.5" x2="361.5" y1="594.2344" y2="607.2344"/><line style="stroke:#181818;stroke-width:1.0;" x1="320.5" x2="361.5" y1="607.2344" y2="607.2344"/><polygon fill="#181818" points="330.5,603.2344,320.5,607.2344,330.5,611.2344,326.5,607.2344" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="326.5" y="589.3779">reset pulse count</text><path d="M408,627.2344 L408,669.2344 L547,669.2344 L547,637.2344 L537,627.2344 L408,627.2344 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M537,627.2344 L537,637.2344 L547,637.2344 L537,627.2344 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="414" y="645.7295">4s timeout complete</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82" x="414" y="662.0811">no more digits</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="750.5" x="0" y="696.1133"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="750.5" y1="696.1133" y2="696.1133"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="750.5" y1="699.1133" y2="699.1133"/><rect fill="#EEEEEE" height="24.3516" style="stroke:#000000;stroke-width:2.0;" width="228" x="261.25" y="684.9375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="210" x="267.25" y="702.4326">ringing (4 seconds after last digit)</text><polygon fill="#181818" points="330.5,737.6406,320.5,741.6406,330.5,745.6406,326.5,741.6406" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="324.5" x2="476.5" y1="741.6406" y2="741.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66" x="336.5" y="736.7842">play ringing</text><polygon fill="#181818" points="137.5,767.9922,127.5,771.9922,137.5,775.9922,133.5,771.9922" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="131.5" x2="318.5" y1="771.9922" y2="771.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="143.5" y="767.1357">play 0002_ringing.mp3</text><line style="stroke:#181818;stroke-width:1.0;" x1="477.5" x2="519.5" y1="802.3438" y2="802.3438"/><line style="stroke:#181818;stroke-width:1.0;" x1="519.5" x2="519.5" y1="802.3438" y2="815.3438"/><line style="stroke:#181818;stroke-width:1.0;" x1="478.5" x2="519.5" y1="815.3438" y2="815.3438"/><polygon fill="#181818" points="488.5,811.3438,478.5,815.3438,488.5,819.3438,484.5,815.3438" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49" x="484.5" y="797.4873">delay 5s</text><line style="stroke:#181818;stroke-width:1.0;" x1="477.5" x2="519.5" y1="845.6953" y2="845.6953"/><line style="stroke:#181818;stroke-width:1.0;" x1="519.5" x2="519.5" y1="845.6953" y2="858.6953"/><line style="stroke:#181818;stroke-width:1.0;" x1="478.5" x2="519.5" y1="858.6953" y2="858.6953"/><polygon fill="#181818" points="488.5,854.6953,478.5,858.6953,488.5,862.6953,484.5,858.6953" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50" x="484.5" y="840.8389">compare</text><path d="M84,873.6953 L145,873.6953 L145,882.0469 L135,892.0469 L84,892.0469 L84,873.6953 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="185.1094" style="stroke:#000000;stroke-width:1.5;" width="570.5" x="84" y="873.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="99" y="888.1904">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="59" x="160" y="887.1143">[no match]</text><polygon fill="#181818" points="330.5,910.3984,320.5,914.3984,330.5,918.3984,326.5,914.3984" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="324.5" x2="476.5" y1="914.3984" y2="914.3984"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="336.5" y="909.542">play wrong number</text><polygon fill="#181818" points="137.5,940.75,127.5,944.75,137.5,948.75,133.5,944.75" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="131.5" x2="318.5" y1="944.75" y2="944.75"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169" x="143.5" y="939.8936">play 0003_wrongnumber.mp3</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="84" x2="654.5" y1="953.75" y2="953.75"/><line style="stroke:#181818;stroke-width:1.0;" x1="477.5" x2="519.5" y1="977.1016" y2="977.1016"/><line style="stroke:#181818;stroke-width:1.0;" x1="519.5" x2="519.5" y1="977.1016" y2="990.1016"/><line style="stroke:#181818;stroke-width:1.0;" x1="478.5" x2="519.5" y1="990.1016" y2="990.1016"/><polygon fill="#181818" points="488.5,986.1016,478.5,990.1016,488.5,994.1016,484.5,990.1016" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158" x="484.5" y="972.2451">set puzzle state to "solved"</text><polygon fill="#181818" points="330.5,1016.4531,320.5,1020.4531,330.5,1024.4531,326.5,1020.4531" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="324.5" x2="476.5" y1="1020.4531" y2="1020.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134" x="336.5" y="1015.5967">play success message</text><polygon fill="#181818" points="137.5,1046.8047,127.5,1050.8047,137.5,1054.8047,133.5,1050.8047" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="131.5" x2="318.5" y1="1050.8047" y2="1050.8047"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141" x="143.5" y="1045.9482">play 0004_success.mp3</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="750.5" x="0" y="1086.9805"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="750.5" y1="1086.9805" y2="1086.9805"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="750.5" y1="1089.9805" y2="1089.9805"/><rect fill="#EEEEEE" height="24.3516" style="stroke:#000000;stroke-width:2.0;" width="86" x="332.25" y="1075.8047"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="68" x="338.25" y="1093.2998">on hangup</text><polygon fill="#181818" points="307.5,1128.5078,317.5,1132.5078,307.5,1136.5078,311.5,1132.5078" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="57" x2="313.5" y1="1132.5078" y2="1132.5078"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49" x="64" y="1127.6514">on_hook</text><polygon fill="#181818" points="137.5,1158.8594,127.5,1162.8594,137.5,1166.8594,133.5,1162.8594" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="131.5" x2="318.5" y1="1162.8594" y2="1162.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="60" x="143.5" y="1158.0029">stop audio</text><polygon fill="#181818" points="465.5,1189.2109,475.5,1193.2109,465.5,1197.2109,469.5,1193.2109" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="319.5" x2="471.5" y1="1193.2109" y2="1193.2109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84" x="326.5" y="1188.3545">send "onhook"</text><line style="stroke:#181818;stroke-width:1.0;" x1="477.5" x2="519.5" y1="1223.5625" y2="1223.5625"/><line style="stroke:#181818;stroke-width:1.0;" x1="519.5" x2="519.5" y1="1223.5625" y2="1236.5625"/><line style="stroke:#181818;stroke-width:1.0;" x1="478.5" x2="519.5" y1="1236.5625" y2="1236.5625"/><polygon fill="#181818" points="488.5,1232.5625,478.5,1236.5625,488.5,1240.5625,484.5,1236.5625" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187" x="484.5" y="1218.7061">clear phone number being dialed</text><!--MD5=[cb6e35f86e293383f323e9a1ce04ef91]
@startuml 
participant phone as phone
box
participant dfplayer as df
participant pi as client
end box 
participant server as server

== Pick up handset ==
phone -> client: off_hook
client -> df: play 0001_dialtone.mp3
client -> server: send "offhook"
== dialing ==
phone -> client: on_dialing
client -> df: stop audio
loop for each digit
    loop for each dial pulse
        phone -> client: on_pulse
        client -> client: increment count (digit)
    end 
    phone -> client: digit complete
    client -> server: send <digit>
    server -> server: append digit to phone number being dialed
    server -> server: start 4s timeout
    client -> client: reset pulse count
end
note over server: 4s timeout complete\nno more digits

== ringing (4 seconds after last digit) ==
server -> client: play ringing
client -> df: play 0002_ringing.mp3
server -> server: delay 5s
server -> server: compare
alt no match
  server -> client: play wrong number
  client -> df: play 0003_wrongnumber.mp3
else 
  server -> server: set puzzle state to "solved"
  server -> client: play success message
  client -> df: play 0004_success.mp3

end

== on hangup ==
phone -> client: on_hook
client -> df: stop audio
client -> server: send "onhook"
server -> server: clear phone number being dialed

hide footbox
@enduml

PlantUML version 1.2022.7(Mon Aug 22 13:01:30 EDT 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: Cp1252
Language: en
Country: CA
--></g></svg>